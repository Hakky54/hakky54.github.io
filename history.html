<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/markdown/history.md at 2020-04-30
 | Rendered using Apache Maven Fluido Skin 1.8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>SSLContext Kickstart &#x2013; History</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.8.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/Hakky54/sslcontext-kickstart">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>SSLContext Kickstart</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2020-04-30<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 3.0.9</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li class="active"><a href="#"><span class="none"></span>History</a></li>
    <li><a href="usage.html" title="Usage"><span class="none"></span>Usage</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<section><section>
<h3><a name="History"></a>History</h3>
<p>As a Java developer I worked for different kinds of clients. Most of the time the application required to call other microservices within the organization or some other http servers. It was required to be HTTPS configured and so I began writing the code which was needed to configure the Http Client to communicate over ssl/tls. And every time I needed to write almost the same code over and over again which is in my opinion very verbose and hard to unit test. See below for an example:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import javax.net.ssl.KeyManager;
import javax.net.ssl.KeyManagerFactory;
import javax.net.ssl.SSLContext;
import javax.net.ssl.TrustManager;
import javax.net.ssl.TrustManagerFactory;
import java.io.IOException;
import java.io.InputStream;
import java.security.KeyManagementException;
import java.security.KeyStore;
import java.security.KeyStoreException;
import java.security.NoSuchAlgorithmException;
import java.security.SecureRandom;
import java.security.UnrecoverableKeyException;
import java.security.cert.CertificateException;
import java.util.Objects;

public class App {
    
    public static void main(String[] args) throws KeyStoreException, NoSuchAlgorithmException, 
            KeyManagementException, IOException, CertificateException, UnrecoverableKeyException {
        
        String keyStorePath = &quot;keystore.p12&quot;;
        String trustStorePath = &quot;truststore.p12&quot;;
        
        char[] keyStorePassword = &quot;secret&quot;.toCharArray();
        char[] trustStorePassword = &quot;secret&quot;.toCharArray();

        KeyStore keyStore = KeyStore.getInstance(&quot;PKCS12&quot;);
        KeyStore trustStore = KeyStore.getInstance(&quot;PKCS12&quot;);
        
        
        try(InputStream keyStoreInputStream = App.class.getClassLoader().getResourceAsStream(keyStorePath);
            InputStream trustStoreInputStream = App.class.getClassLoader().getResourceAsStream(trustStorePath)) {

            Objects.requireNonNull(keyStoreInputStream);
            Objects.requireNonNull(trustStoreInputStream);
            
            keyStore.load(keyStoreInputStream, keyStorePassword);
            trustStore.load(trustStoreInputStream, trustStorePassword);
        }
        
        KeyManagerFactory keyManagerFactory = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
        keyManagerFactory.init(keyStore, keyStorePassword);
        KeyManager[] keyManagers = keyManagerFactory.getKeyManagers();

        TrustManagerFactory trustManagerFactory = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
        trustManagerFactory.init(trustStore);
        TrustManager[] trustManagers = trustManagerFactory.getTrustManagers();

        SSLContext sslContext = SSLContext.getInstance(&quot;TLSv1.2&quot;);
        sslContext.init(keyManagers, trustManagers, new SecureRandom());
    }
    
}
</pre></div></div>

<p>The above snippet is an example for creating a SSLContext with a key and a trust material. I am not only considering the amount of lines which needed to be written to create the SSLContext but it requires also a lot knowledge of the developer to just write this. You need to know how to properly load your file into your application and consume it as a KeyStore instance. Therefor you also need to learn how to properly create a KeyManagerFactory, TrustManagerFactory and SSLContext. The above snippet needs to be rewritten if you use a Http Client which relies on libraries of Jetty or Netty and therefor it makes it even more complex. The code above can be rewritten with the snippet below:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import nl.altindag.sslcontext.SSLFactory;

import javax.net.ssl.SSLContext;

public class App {

    public static void main(String[] args) {
        SSLFactory sslFactory = SSLFactory.builder()
                .withIdentity(&quot;keystore.p12&quot;, &quot;secret&quot;.toCharArray(), &quot;PKCS12&quot;)
                .withTrustStore(&quot;truststore.p12&quot;, &quot;secret&quot;.toCharArray(), &quot;PKCS12&quot;)
                .build();
        
        SSLContext sslContext = sslFactory.getSslContext();
    }

}
</pre></div></div>

<p>The sslcontext-kickstart library is taking the responsibility of creating an instance of SSLContext from the provided arguments. I wanted to be as easy as possible to use to give every developer a kickstart when configuring their Http Client. So feel free to provide feedback or feature requests. The library also provide other utilities such as <a class="externalLink" href="https://github.com/Hakky54/sslcontext-kickstart/blob/master/sslcontext-kickstart/src/main/java/nl/altindag/sslcontext/util/KeyStoreUtils.java">KeyStoreUtils</a>, <a class="externalLink" href="https://github.com/Hakky54/sslcontext-kickstart/blob/master/sslcontext-kickstart/src/main/java/nl/altindag/sslcontext/util/KeyManagerUtils.java">KeyManagerUtils</a> and <a class="externalLink" href="https://github.com/Hakky54/sslcontext-kickstart/blob/master/sslcontext-kickstart/src/main/java/nl/altindag/sslcontext/util/TrustManagerUtils.java">TrustManagerUtils</a>. See the <a class="externalLink" href="https://sslcontext-kickstart.com/apidocs/index.html">javadoc</a> for all the options.</p>
<p>Other libraries also provide the same kind of factories/builders such as <a class="externalLink" href="https://hc.apache.org/httpcomponents-core-4.4.x/httpcore/apidocs/org/apache/http/ssl/SSLContextBuilder.html">Apache SSLContextBuilder</a> or <a class="externalLink" href="https://netty.io/4.0/api/io/netty/handler/ssl/SslContextBuilder.html">Netty SslContextBuilder</a> or <a class="externalLink" href="https://www.eclipse.org/jetty/javadoc/9.4.26.v20200117/org/eclipse/jetty/util/ssl/SslContextFactory.html">Jetty SslContextFactory</a> but the downside of using those libraries is that you also pull in their Http Client, transitive dependencies and other heavy not required classes. It will therefor make your executable fat jar even more fatter. Therefor most of the developer prefer to write the code by themselves to instantiate an SSLContext instead of using the libraries of Apache, Netty and Jetty.</p></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &#169;      2020..</p>
        </div>
      </div>
    </footer>
  </body>
</html>

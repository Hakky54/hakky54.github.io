<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/markdown/usage.md at 2020-04-16
 | Rendered using Apache Maven Fluido Skin 1.8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>SSLContext Kickstart &#x2013; Usage</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.8.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/Hakky54/sslcontext-kickstart">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>SSLContext Kickstart</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2020-04-16<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 3.0.8</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li class="active"><a href="#"><span class="none"></span>Usage</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<section>
<h2><a name="Usage"></a>Usage</h2><section>
<h3><a name="Definitions"></a>Definitions</h3>
<ul>

<li>Identity: A KeyStore which holds the key pair also known as private and public key</li>
<li>TrustStore: A KeyStore containing one or more certificates also known as public key. This KeyStore contains a list of trusted certificates</li>
<li>One way authentication (also known as one way tls, one way ssl): Https connection where the client validates the certificate of the counter party</li>
<li>Two way authentication (also known as two way tls, two way ssl, mutual authentication): Https connection where the client as well as the counter party validates the certificate, also known as mutual authentication</li>
</ul></section><section>
<h3><a name="SSLFactory_configurations"></a>SSLFactory configurations</h3>
<p>SSLFactory can be enriched with additional configuration with the fluent api. It has already built-in default values for SecureRandom, HostnameVerifier, Encryption protocol, but can be overridden if required, see below for examples and additional configurations.</p>
<p>One way authentication with custom trustStore</p>

<div class="source">
<div class="source"><pre class="prettyprint">SSLFactory.builder()
          .withTrustStore(trustStore, trustStorePassword)
          .build();
</pre></div></div>

<p>One way authentication while trusting all certificates without validation, not recommended to use at production!</p>

<div class="source">
<div class="source"><pre class="prettyprint">SSLFactory.builder()
          .withTrustingAllCertificatesWithoutValidation()
          .build();
</pre></div></div>

<p>One way authentication with specific encryption protocol version, custom secure random and option to validate the hostname within the request against the SAN field of a certificate. If you are using java 11 or newer, than you are also able to use TLSv1.3 as encryption protocol. Just provide <code>TLSv1.3</code> as protocol argument and it will work out-of-the-box.</p>

<div class="source">
<div class="source"><pre class="prettyprint">SSLFactory.builder()
          .withTrustStore(trustStore, trustStorePassword)
          .withHostnameVerifier(hostnameVerifier)
          .withSecureRandom(secureRandom)
          .withProtocol(&quot;TLSv1.2&quot;)
          .build();
</pre></div></div>

<p>Two way authentication with custom trustStore, hostname verifier and encryption protocol version</p>

<div class="source">
<div class="source"><pre class="prettyprint">SSLFactory.builder()
          .withIdentity(identity, identityPassword)
          .withTrustStore(trustStore, trustStorePassword)
          .withHostnameVerifier(hostnameVerifier)
          .withProtocol(&quot;TLSv1.2&quot;)
          .build();
</pre></div></div>

<p>Support for using multiple identities and trustStores</p>

<div class="source">
<div class="source"><pre class="prettyprint">SSLFactory.builder()
          .withIdentity(identityA, identityPasswordA)
          .withIdentity(identityB, identityPasswordB)
          .withIdentity(identityC, identityPasswordC)
          .withTrustStore(trustStoreA, trustStorePasswordA)
          .withTrustStore(trustStoreB, trustStorePasswordB)
          .withTrustStore(trustStoreC, trustStorePasswordC)
          .withTrustStore(trustStoreD, trustStorePasswordD)
          .withProtocol(&quot;TLSv1.2&quot;)
          .build();
</pre></div></div>

<p>Support for using X509KeyManager and X509TrustManager</p>

<div class="source">
<div class="source"><pre class="prettyprint">SSLFactory.builder()
          .withKeyManager(keyManager)
          .withTrustManager(trustManager)
          .build();
</pre></div></div>
</section><section>
<h3><a name="Additional_mappers_for_specific_libraries"></a>Additional mappers for specific libraries</h3>
<p>Some http clients relay on different ssl classes from third parties and require mapping from SSLFactory to those libraries. Below you will find the maven dependency which will provide the mapping and also the SSLFactory library. When using one of the below libraries, it is not required to also explicitly include sslcontext-kickstart.</p><section>
<h4><a name="Netty"></a>Netty</h4>
<p>Some know http clients which relay on netty libraries are: <a class="externalLink" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/web-reactive.html">Spring WebFlux WebClient Netty</a>, <a class="externalLink" href="https://github.com/AsyncHttpClient/async-http-client">Async Http Client</a> and <a class="externalLink" href="https://github.com/dispatch/reboot">Dispatch Reboot Http Client</a>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;dependency&gt;
    &lt;groupId&gt;io.github.hakky54&lt;/groupId&gt;
    &lt;artifactId&gt;sslcontext-kickstart-for-netty&lt;/artifactId&gt;
&lt;/dependency&gt;
</pre></div></div>

<p>Example setup for Spring WebClient with Netty:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import io.netty.handler.ssl.SslContext;
import nl.altindag.sslcontext.SSLFactory;
import nl.altindag.sslcontext.util.NettySslContextUtils;
import org.springframework.http.client.reactive.ReactorClientHttpConnector;
import org.springframework.web.reactive.function.client.WebClient;
import reactor.netty.http.client.HttpClient;

import javax.net.ssl.SSLException;

public class App {
    
    public static void main(String[] args) throws SSLException {
        SSLFactory sslFactory = SSLFactory.builder()
                .withDefaultJdkTrustStore()
                .build();

        SslContext sslContext = NettySslContextUtils.forClient(sslFactory).build();
        HttpClient httpClient = HttpClient.create()
                .secure(sslSpec -&gt; sslSpec.sslContext(sslContext));

        WebClient webClient = WebClient.builder()
                .clientConnector(new ReactorClientHttpConnector(httpClient))
                .build();
    }

}
</pre></div></div>
</section><section>
<h4><a name="Jetty"></a>Jetty</h4>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;dependency&gt;
    &lt;groupId&gt;io.github.hakky54&lt;/groupId&gt;
    &lt;artifactId&gt;sslcontext-kickstart-for-jetty&lt;/artifactId&gt;
&lt;/dependency&gt;
</pre></div></div>

<p>Example setup for <a class="externalLink" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/web-reactive.html">Spring WebFlux WebClient Jetty</a>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import nl.altindag.sslcontext.SSLFactory;
import nl.altindag.sslcontext.util.JettySslContextUtils;
import org.eclipse.jetty.client.HttpClient;
import org.eclipse.jetty.util.ssl.SslContextFactory;
import org.springframework.http.client.reactive.JettyClientHttpConnector;
import org.springframework.web.reactive.function.client.WebClient;

public class App {

    public static void main(String[] args) {
        SSLFactory sslFactory = SSLFactory.builder()
                .withDefaultJdkTrustStore()
                .build();
        
        SslContextFactory.Client sslContextFactory = JettySslContextUtils.forClient(sslFactory);
        HttpClient httpClient = new HttpClient(sslContextFactory);

        WebClient webClient = WebClient.builder()
                .clientConnector(new JettyClientHttpConnector(httpClient))
                .build();
    }

}
</pre></div></div>
</section><section>
<h4><a name="Apache"></a>Apache</h4>
<p>Apache Http Client works with javax.net.ssl.SSLContext, so an additional mapping to their library is not required, <a href="./index.html">see here</a>. However it is still possible to configure the http client with their custom configuration class. you can find below an example configuration for that use case:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;dependency&gt;
    &lt;groupId&gt;io.github.hakky54&lt;/groupId&gt;
    &lt;artifactId&gt;sslcontext-kickstart-for-apache&lt;/artifactId&gt;
&lt;/dependency&gt;
</pre></div></div>

<div class="source">
<div class="source"><pre class="prettyprint">import nl.altindag.sslcontext.SSLFactory;
import nl.altindag.sslcontext.util.ApacheSslContextUtils;
import org.apache.http.client.HttpClient;
import org.apache.http.conn.socket.LayeredConnectionSocketFactory;
import org.apache.http.impl.client.HttpClients;

public class App {

    public static void main(String[] args) {
        SSLFactory sslFactory = SSLFactory.builder()
                .withDefaultJdkTrustStore()
                .build();

        LayeredConnectionSocketFactory socketFactory = ApacheSslContextUtils.toLayeredConnectionSocketFactory(sslFactory);

        HttpClient httpClient = HttpClients.custom()
                .setSSLSocketFactory(socketFactory)
                .build();
    }

}
</pre></div></div></section></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &#169;      2020..</p>
        </div>
      </div>
    </footer>
  </body>
</html>
